<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PAST TRADING</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <!-- ============================================================ -->
  <!-- MENU SCREEN                                                    -->
  <!-- ============================================================ -->
  <div id="menu-screen">
    <div class="menu-container">
      <h1 class="menu-title">PAST TRADING</h1>
      <p class="menu-subtitle">Travel back in time. Trade with foresight. Try not to get arrested.</p>

      <div class="menu-stats">
        <div class="stat-card">
          <h3>Prestige Points</h3>
          <div class="stat-value" id="menu-pp">0</div>
        </div>
        <div class="stat-card">
          <h3>Runs Completed</h3>
          <div class="stat-value" id="menu-run-count">0</div>
        </div>
      </div>

      <!-- Trading Modes -->
      <div class="menu-section">
        <h2>Select Mode</h2>
        <div id="mode-selector" class="mode-grid"></div>
      </div>

      <!-- Unlock Shop -->
      <div class="menu-section">
        <h2>Unlock Shop</h2>
        <div id="unlock-shop"></div>
      </div>

      <!-- Equipable Tools -->
      <div class="menu-section">
        <h2>Equipable Tools</h2>
        <div id="tool-selector"></div>
      </div>

      <!-- Titles -->
      <div class="menu-section">
        <h2>Titles</h2>
        <div id="title-selector"></div>
      </div>

      <!-- Achievements -->
      <div class="menu-section">
        <h2>Achievements</h2>
        <div id="menu-achievements"></div>
      </div>

      <!-- Leaderboards -->
      <div class="menu-section">
        <h2>Leaderboards</h2>
        <div id="menu-leaderboards"></div>
      </div>

      <!-- Reset -->
      <div class="menu-section" style="text-align: center; padding: 20px 0;">
        <button class="btn btn-danger" onclick="if(confirm('Reset ALL progress?')) { game.progression.resetProgress(); game.showMenu(); }">
          Reset Progress
        </button>
      </div>
    </div>
  </div>

  <!-- ============================================================ -->
  <!-- GAME SCREEN                                                    -->
  <!-- ============================================================ -->
  <div id="game-screen" class="hidden">

    <!-- Header -->
    <div class="game-header">
      <div class="header-left">
        <span class="day-counter" id="day-counter">Day 0 / 365</span>
        <span class="countdown-timer" id="countdown-timer">T-365 days</span>
        <div class="speed-controls">
          <button class="speed-btn" data-speed="0.5">0.5x</button>
          <button class="speed-btn active" data-speed="1">1x</button>
          <button class="speed-btn" data-speed="2">2x</button>
          <button class="speed-btn" data-speed="5">5x</button>
          <button class="speed-btn" data-speed="10">10x</button>
        </div>
      </div>
      <div class="audio-controls">
        <button id="mute-btn" class="icon-btn" title="Mute">üîä</button>
        <input type="range" id="volume-slider" min="0" max="100" value="70" class="volume-slider">
        <button class="btn btn-small" id="pause-btn">Pause</button>
        <button class="btn btn-small btn-danger" id="exit-btn">Exit</button>
      </div>
    </div>

    <!-- Left: Trading Panel -->
    <div class="trading-panel">
      <!-- Asset Selector -->
      <div class="panel-section">
        <div class="section-title">Assets</div>
        <div id="asset-selector" class="asset-list"></div>
      </div>

      <!-- Trade Controls -->
      <div class="trade-controls">
        <div class="quantity-input-group">
          <label>Quantity</label>
          <div class="quantity-input-wrapper">
            <input type="number" id="trade-quantity" value="10" min="1" max="99999">
            <button class="btn btn-small btn-max" id="max-qty-btn">Max</button>
          </div>
        </div>
        <div class="trade-button-column">
          <button class="btn btn-primary" id="buy-btn">Buy</button>
          <button class="btn btn-accent" id="sell-btn">Sell</button>
          <button class="btn btn-danger" id="short-btn">Short</button>
        </div>
        <div class="cooldown-indicator" id="cooldown-indicator">Ready</div>
        <div id="trade-result"></div>
      </div>

      <!-- Positions -->
      <div class="panel-section" style="flex: 1; overflow-y: auto;">
        <div class="section-title">Positions</div>
        <div id="portfolio-list" class="positions-list"></div>
      </div>

      <!-- Actions -->
      <div class="actions-bar" id="actions-panel"></div>
    </div>

    <!-- Center: Chart Area -->
    <div class="center-panel">
      <div class="chart-tabs-bar" id="chart-tabs-bar">
        <div class="tabs-scroll-container" id="tabs-scroll"></div>
        <button class="tab-add-btn" id="add-chart-btn" title="Add chart">+</button>
      </div>
      <div class="chart-container" id="chart-container"></div>
    </div>

    <!-- Right: Stats & News -->
    <div class="right-panel">
      <!-- Net Worth -->
      <div class="stat-card">
        <h3>Net Worth</h3>
        <div class="stat-value" id="net-worth-display">$10,000</div>
        <div class="stat-subvalue">
          Cash: <span id="cash-display">$10,000</span>
        </div>
        <canvas id="net-worth-graph"></canvas>
      </div>

      <!-- Meters -->
      <div class="meters-row">
        <div class="meter">
          <div class="meter-label">
            <span class="meter-name">Internal Risk</span>
            <span class="meter-value" id="risk-value">0%</span>
          </div>
          <div class="meter-bar">
            <div class="meter-fill risk" id="risk-fill" style="width: 0%"></div>
          </div>
        </div>
        <div class="meter">
          <div class="meter-label">
            <span class="meter-name">SEC Attention</span>
            <span class="meter-value" id="sec-value">0%</span>
          </div>
          <div class="meter-bar">
            <div class="meter-fill sec" id="sec-fill" style="width: 0%"></div>
          </div>
          <div class="meter-subtext">
            <span class="sec-label" id="sec-label">Off the radar</span>
          </div>
        </div>
      </div>

      <!-- News Feed -->
      <div class="news-feed-container">
        <h3>Market News</h3>
        <div id="news-feed" class="news-feed"></div>
      </div>
    </div>

    <!-- Bottom Bar -->
    <div class="bottom-bar">
      <div class="bottom-stat">
        <div class="bottom-stat-item">
          <span class="bottom-stat-label">Mode:</span>
          <span class="bottom-stat-value" id="mode-display">Stocks</span>
        </div>
      </div>
      <div class="bottom-stat">
        <div class="bottom-stat-item">
          <span class="bottom-stat-label">Tool:</span>
          <span class="bottom-stat-value" id="tool-display">None</span>
        </div>
      </div>
      <div class="bottom-stat">
        <div class="bottom-stat-item">
          <span class="bottom-stat-label">P&L:</span>
          <span class="bottom-stat-value" id="pnl-display">$0</span>
        </div>
      </div>
    </div>

    <!-- Pause Overlay -->
    <div id="pause-overlay" class="pause-overlay hidden">
      <div class="pause-content">
        <h2>‚è∏ PAUSED</h2>
        <button class="btn btn-primary" id="unpause-btn">Resume</button>
      </div>
    </div>

    <!-- Insider Trading Modal -->
    <div id="insider-modal" class="insider-modal hidden">
      <div class="insider-content">
        <h2>ü§´ Insider Tip Available</h2>
        <p class="insider-tip-text" id="insider-tip-text"></p>
        <p class="insider-warning">Warning: +12 SEC Attention</p>
        <div class="insider-buttons">
          <button class="btn btn-danger" id="insider-accept">Accept Tip</button>
          <button class="btn" id="insider-ignore">Ignore</button>
        </div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
      <div class="loading-spinner"></div>
      <div class="loading-text">Loading market data...</div>
    </div>

    <!-- Achievement Popup -->
    <div id="achievement-popup" class="hidden"></div>
  </div>

  <!-- ============================================================ -->
  <!-- RUN END SCREEN                                                 -->
  <!-- ============================================================ -->
  <div id="run-end-screen" class="hidden">
    <div class="run-end-container">
      <h1 id="run-end-title" class="run-end-title">RUN OVER</h1>

      <div id="run-end-stats" class="run-end-stats"></div>

      <h3 style="margin-top: 20px;">NEW ACHIEVEMENTS</h3>
      <div id="run-end-achievements"></div>

      <button class="btn btn-primary mt-2" id="back-to-menu">BACK TO MENU</button>
    </div>
  </div>

  <!-- ============================================================ -->
  <!-- SCRIPTS (order matters)                                        -->
  <!-- ============================================================ -->
  <script src="js/config.js"></script>
  <script src="js/data_loader.js"></script>
  <script src="js/market.js"></script>
  <script src="js/trading.js"></script>
  <script src="js/sec.js"></script>
  <script src="js/news.js"></script>
  <script src="js/progression.js"></script>
  <script src="js/achievements.js"></script>
  <script src="js/leaderboard.js"></script>
  <script src="js/chart_manager.js"></script>
  <script src="js/audio_engine.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/main.js"></script>

</body>
</html>
